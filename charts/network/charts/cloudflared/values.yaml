# Cloudflared configuration
replicaCount: 1

image:
  repository: cloudflare/cloudflared
  tag: latest
  pullPolicy: IfNotPresent

# Tunnel token secret (existing secret)
tunnelToken:
  secretName: tunnel-token
  secretKey: token

# Ingress configuration for routing to Traefik
ingress:
  enabled: true
  rules:
    - hostname: "holoconnect.link"
      service: "http://network-traefik.network.svc.cluster.local:80"
      originRequest:
        noTLSVerify: true
    - hostname: "*.holoconnect.link"
      service: "http://network-traefik.network.svc.cluster.local:80"
      originRequest:
        noTLSVerify: true
    - hostname: "k3s.knoesen.link"
      service: "http://network-traefik.network.svc.cluster.local:80"
      originRequest:
        noTLSVerify: true
    - hostname: "*.k3s.knoesen.link"
      service: "http://network-traefik.network.svc.cluster.local:80"
      originRequest:
        noTLSVerify: true
    - service: "http_status:404"

# Cloudflared command options
cloudflared:
  logLevel: debug
  noAutoUpdate: true
  metrics:
    enabled: true
    port: 2000

# Security context
securityContext:
  sysctls:
    - name: net.ipv4.ping_group_range
      value: "65532 65532"

# Liveness probe configuration
livenessProbe:
  enabled: true
  httpGet:
    path: /ready
    port: 2000
  failureThreshold: 1
  initialDelaySeconds: 10
  periodSeconds: 10

# Service configuration (optional - for exposing metrics)
service:
  enabled: false
  type: ClusterIP
  port: 2000
